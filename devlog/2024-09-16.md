# Journal de dÃ©veloppement technique - IRIMMetaBrain / IRIMMetaBrain

## ğŸ“… Session 2024-09-16 - Architecture ComplÃ¨te

### ğŸ¯ RÃ©alisations principales

#### Phase 1: Harmonisation Design System

- âœ… **Audit complet du thÃ¨me** : Suppression de TOUS les hardcoded values
  - 20 valeurs px remplacÃ©es par theme.spacing
  - 18 couleurs hex remplacÃ©es par theme.colors
  - Enrichissement du thÃ¨me (spacing 3xsâ†’3xl, couleurs systÃ¨me)
- âœ… **Principe DRY appliquÃ©** : 100% des styles utilisent maintenant le thÃ¨me

#### Phase 2: SystÃ¨me AsyncStorage GitHub

- âœ… **SyncManager complet** avec chiffrement AES-256
  - PBKDF2 10k iterations pour dÃ©rivation de clÃ©
  - GitHub Gist comme backend
  - Singleton pattern pour le service
- âœ… **Modal de synchronisation** avec UI complÃ¨te

#### Phase 3: SystÃ¨me de Modales CentralisÃ©

- âœ… **Architecture modulaire** avec 3 variantes :
  - `overlay` : Modale classique plein Ã©cran
  - `roomCanvas` : Remplace exactement la zone RoomCanvas (80%)
  - `baseFloorTower` : Remplace la zone SideTowerNotes (320px)
- âœ… **React Portals** : Render intelligent dans le bon container
- âœ… **Centralisation des actions** dans `buttonMapping.js`
- âœ… **ModalManager** : Gestion centralisÃ©e, une seule modale active

#### Phase 4: Navigation DorÃ©e Premium

- âœ… **FlÃ¨ches dorÃ©es** remplaÃ§ant les emojis
  - Une seule image, 4 rotations CSS (0Â°, 90Â°, 180Â°, 270Â°)
  - Animations hover (scale + glow dorÃ©)
  - Structure modulaire dans `/navigation/`
- âœ… **Fade UX pendant navigation**
  - Ã‰tat `isNavigating` + `activeDirection`
  - Opacity dynamique (0.2 inactive, 0.5 active, 1 au repos)
  - Timing parfait avec la transition de grille (500ms)

### ğŸ—ï¸ DÃ©cisions Architecturales (ADR)

#### ADR-001: React Portals pour Modales

- **Contexte** : Besoin de render des modales dans diffÃ©rentes zones
- **DÃ©cision** : Utiliser createPortal avec IDs spÃ©cifiques
- **ConsÃ©quences** : FlexibilitÃ© maximale, performance optimale

#### ADR-002: Une Image pour 4 Directions

- **Contexte** : 4 flÃ¨ches de navigation nÃ©cessaires
- **DÃ©cision** : Une seule image + rotations CSS
- **ConsÃ©quences** : -75% de requÃªtes rÃ©seau, maintenance simplifiÃ©e

#### ADR-003: Centralisation Actions dans buttonMapping

- **Contexte** : Actions dispersÃ©es dans plusieurs composants
- **DÃ©cision** : Centraliser avec systÃ¨me de handlers
- **ConsÃ©quences** : Source unique de vÃ©ritÃ©, Ã©vite la duplication

### ğŸ”¥ LeÃ§ons Apprises

1. **PiÃ¨ge Styled-Components** : Les variantes override TOUT le transform

   - Solution : GÃ©rer les transforms dans chaque variante

2. **Transient Props** : `$variant` vs `variant`

   - Les props sans $ sont passÃ©es au DOM â†’ erreurs console

3. **Keyframes en v4** : Ne plus wrapper avec `` css`${keyframe}` ``

   - Utiliser directement : `animation: ${fadeIn} 0.3s`

4. **useEffect Dependencies** : Ã‰tat dans handler = closure stale
   - Solution : useRef ou dÃ©placer le handler dans useEffect

### ğŸ“Š MÃ©triques de Session

- **Commits** : 8 commits atomiques bien documentÃ©s
- **Fichiers touchÃ©s** : 23 fichiers
- **Lignes ajoutÃ©es** : ~1500
- **Nouveaux composants** : 10
- **Patterns Ã©tablis** : 4 (Portal, Singleton, Centralisation, Fade UX)

### ğŸ¯ Prochaines Ã©tapes

- [ ] SystemOverview.jsx avec introspection
- [ ] Storybook lÃ©ger intÃ©grÃ©
- [ ] Tests visuels automatisÃ©s
- [ ] Documentation ADR complÃ¨te

---

_Ce document est maintenu pour tracer l'Ã©volution technique du projet IRIMMetaBrain / IRIMMetaBrain_
